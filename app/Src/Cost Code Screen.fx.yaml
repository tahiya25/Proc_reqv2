"'Cost Code Screen' As screen":
    Fill: =RGBA(244, 244, 244, 1)
    OnVisible: =

    lblCC_CCS_4 As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =39
        Size: =14
        Text: ="Expected Date"
        Width: =190
        X: =408
        Y: =794
        ZIndex: =1

    dp_cced As datepicker:
        BorderColor: |-
            =ColorValue("#ccf5ff")
        BorderThickness: =0
        DefaultDate: =varCurrentCostCode.'Date Required'
        Font: =Font.Lato
        Height: =56
        IconBackground: =theme.AppColor
        Size: =15
        Width: =206
        X: =415
        Y: =833
        ZIndex: =2

    dd_ccuom As dropdown:
        BorderColor: |-
            =ColorValue("#ccf5ff")
        BorderThickness: =0
        ChevronBackground: =theme.AppColor
        Default: =varCurrentCostCode.UOM
        Font: =Font.Lato
        Height: =57
        Items: ='Unit of Measure'.Code
        Size: =16
        Width: =179
        X: =194
        Y: =726
        ZIndex: =3

    lblCC_CCS_5 As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =34
        Size: =14
        Text: ="UOM"
        Width: =77
        X: =194
        Y: =691
        ZIndex: =4

    grp_Header_RS_2 As group:
        Height: =5
        Width: =5
        X: =88
        Y: =6
        ZIndex: =4

        Rectangle1_9 As rectangle:
            Fill: =theme.AppColor
            Height: =86
            OnSelect: =
            Width: =550
            X: =90
            ZIndex: =12

        Image1_6 As image:
            Height: =86
            Image: =RecProc
            OnSelect: |-
                =If(
                    !IsBlank(Param("ID")),
                    Patch(ReqHeader, LookUp(ReqHeader,Title=Param("ID")),
                    {
                        Status:{Value: "Coded" ,
                                '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference"}
                    })
                ,   
                    Patch(ReqHeader, LookUp(ReqHeader,Title=varCurrentReqHeader.Title),
                    {
                        Status:{Value: "Coded" ,
                                '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference"}
                    })
                
                
                );
                
                Navigate('Requisitions Screen')
            Width: =94
            ZIndex: =13

        Label1_4 As label:
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.Lato
            Height: =83
            PaddingLeft: =20
            Size: =21
            Text: ="Cost Codes"
            Width: =404
            X: =188
            Y: =1
            ZIndex: =14

    drpgalVendor_CCS As combobox:
        BorderColor: |-
            =ColorValue("#ccf5ff")
        BorderThickness: =1
        ChevronBackground: =theme.AppColor
        DefaultSelectedItems: =ForAll(colvendors,Vendor)
        DisplayFields: =["Title","Name1"]
        Font: =Font.Lato
        Height: =52
        Items: =colloadvendors
        SearchFields: =["Title"]
        SearchItems: =Search(colloadvendors,drpgalVendor_CCS.SearchText,"Title")
        SelectMultiple: =false
        Size: =14
        Template: =ListItemTemplate.Double
        Width: =263
        X: =10
        Y: =628
        ZIndex: =5

    lblCC_CCS_2 As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =34
        Size: =14
        Text: ="QTY"
        Width: =77
        X: =22
        Y: =691
        ZIndex: =6

    txt_qty As text:
        BorderColor: |
            =ColorValue("#ccf5ff")
        BorderThickness: =1
        Default: =varCurrentCostCode.Quantity
        Font: =Font.Lato
        Height: =44
        Size: =18
        Width: =125
        X: =17
        Y: =733
        ZIndex: =7

    txt_partno As text:
        BorderColor: |
            =ColorValue("#ccf5ff")
        BorderThickness: =1
        Default: =varCurrentCostCode.Title
        Font: =Font.Lato
        Height: =44
        Size: =18
        Width: =125
        X: =428
        Y: =730
        ZIndex: =8

    lblCC_CCS_3 As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =34
        Size: =14
        Text: ="PartNo"
        Width: =77
        X: =432
        Y: =690
        ZIndex: =9

    Image17 As image:
        Height: =67
        Image: ='1714870'
        OnSelect: |-
            =Set(varcsvimport,true);
            
            Set(varreqheader, LookUp(ReqHeader, Title=varreqid));
            ClearCollect(colDataExported, {ItemType:varCurrentCostCode.ItemType, Item:varCurrentCostCode.Title,ItemName: varCurrentCostCode.ItemDescription,Type: varCurrentCostCode.MaterialType, Location: "", WM:varCurrentCostCode.UOM, Quantity: varCurrentCostCode.Quantity, ExpectedPrice: txtexpectedprice.Text, Dist:"J",JobDept:lblReqJObNo_1.Text, CostCode:varCurrentCostCode.CostCode,Approver: varreqheader.Approver.DisplayName, Category: varCurrentCostCode.Category,Tax1:If(drpgalCat_CCS.Selected.Category="C" || drpgalCat_CCS.Selected.Category="E","NY"), Expected:varCurrentCostCode.DateRequired });
            Set(varFormattedJSON, JSON(colDataExported));
            
            Set(varfilelink,'POReq-ImportCMIC'.Run(varFormattedJSON).filelink);Launch(varfilelink);
            
            Set(varcsvimport,false);
        Tooltip: ="Import CSV"
        Width: =88
        X: =424
        Y: =607
        ZIndex: =10

    Octagon1 As octagon:
        Fill: =theme.Orange
        Height: =50
        Width: =50
        X: =561
        Y: =137
        ZIndex: =11

    lblAddNewReq_1 As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =37
        Size: =14
        Text: ="Req No"
        Width: =116
        X: =23
        Y: =116
        ZIndex: =15

    txtDescription_CCS As text:
        BorderColor: |
            =ColorValue("#ccf5ff")
        BorderThickness: =1
        Default: =varCurrentCostCode.ItemDescription
        FocusedBorderThickness: =0
        Font: =Font.Lato
        Height: =60
        HintText: =""
        HoverFill: |-
            =ColorValue("#ccf5ff")
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =18
        Width: =576
        X: =16
        Y: =931
        ZIndex: =16

    lblReqID_1 As label:
        Height: =31
        Size: =16
        Text: |-
            =If(
                !IsBlank(Param("ID")),
                LookUp(ReqHeader,Title=Param("ID"),Title)
            ,varCurrentReqHeader.Title)
        Width: =116
        Wrap: =false
        X: =23
        Y: =153
        ZIndex: =17

    lblReqIDStatus_1 As label:
        Align: =Align.Center
        Height: =31
        Size: =16
        Text: |-
            =If(
                !IsBlank(Param("ID")),
                LookUp(ReqHeader,Title=Param("ID"),Status.Value),
            varCurrentReqHeader.Status.Value)
        Width: =106
        Wrap: =false
        X: =420
        Y: =153
        ZIndex: =18

    lblReqJObNo_1 As label:
        Align: =Align.Center
        Height: =31
        Size: =16
        Text: |-
            =If(
                !IsBlank(Param("ID")),
                LookUp(ReqHeader,Title=Param("ID"),JobNo),
            varCurrentReqHeader.JobNo)
        Width: =89
        Wrap: =false
        X: =144
        Y: =153
        ZIndex: =19

    lblReqDescription_1 As label:
        Height: =31
        Size: =16
        Text: |-
            =If(
                !IsBlank(Param("ID")),
                LookUp(ReqHeader,Title=Param("ID"),DeliveryLoc),
            varCurrentReqHeader.DeliveryLoc)
        Tooltip: |-
            =If(
                !IsBlank(Param("ID")),
                LookUp(ReqHeader,Title=Param("ID"),DeliveryLoc),
            If(!IsBlank(varNewReqPatch),varNewReqPatch.DeliveryLoc,""))
        Width: =218
        Wrap: =false
        X: =263
        Y: =153
        ZIndex: =20

    lblAddNewReq_2 As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =37
        Size: =14
        Text: ="Job No"
        Width: =116
        X: =144
        Y: =116
        ZIndex: =21

    lblAddNewReq_3 As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =37
        Size: =14
        Text: ="Ship Location"
        Width: =158
        X: =279
        Y: =116
        ZIndex: =22

    lblAddNewReq_4 As label:
        Align: =Align.Center
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =37
        Size: =14
        Text: ="Status"
        Width: =99
        X: =420
        Y: =116
        ZIndex: =23

    lblPartNo_3 As label:
        FontWeight: =Bold
        Height: =31
        Size: =14
        Text: ="Part No"
        Visible: =varShowNewReqDetails
        Width: =103
        X: =10
        Y: =227
        ZIndex: =24

    lblPartNo_4 As label:
        FontWeight: =Bold
        Height: =31
        Size: =14
        Text: ="Description"
        Visible: =varShowNewReqDetails
        Width: =305
        X: =160
        Y: =227
        ZIndex: =25

    galAvailableReqItems_1 As gallery.galleryVertical:
        Height: =314
        Items: |-
            =If(
                !IsBlank(Param("ID")),
                Filter(
                    ReqDetails,ReqID=(Param("ID"))
                       ),
            SortByColumns(Filter(ReqDetails,ReqID=varCurrentReqHeader.Title),"ID",Descending))
        Layout: =Layout.Vertical
        OnSelect: |
            =Set(varCurrentCostCode, ThisItem);
            ClearCollect(colvendors,Filter(ReqDetails,ID=varCurrentCostCode.ID).Vendor);ClearCollect(colcostcode,Filter(ReqDetails,ID=varCurrentCostCode.ID).CostCode);
            ClearCollect(colcategory,Filter(ReqDetails,ID=varCurrentCostCode.ID).Category);ClearCollect(colloadvendors,Vendors)
        TemplateFill: =White
        TemplateSize: =44
        Width: =635
        X: =5
        Y: =258
        ZIndex: =26

        Label8_2 As label:
            Height: =38
            OnSelect: =Select(Parent)
            Size: =12
            Text: =ThisItem.Title
            Width: =111
            X: =36
            ZIndex: =1

        Label8_3 As label:
            Font: =Font.Lato
            Height: =38
            OnSelect: =Select(Parent)
            Size: =12
            Text: =Proper(ThisItem.ItemDescription)
            Tooltip: =ThisItem.ItemDescription
            Width: =422
            X: =111
            ZIndex: =2

        imd_DelRec_2 As image:
            Height: =30
            Image: |-
                ="data:image/svg+xml," & 
                 EncodeUrl(
                    "<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' viewBox='-10 0 2068 2048'>
                  <g transform='matrix(1 0 0 -1 0 2048),rotate(0,1034,1024)'>
                   <path fill='" & theme.AppColorText & "'
                d='M1792 1664h-128v-1472q0 -40 -15 -75t-41 -61t-61 -41t-75 -15h-1024q-40 0 -75 15t-61 41t-41 61t-15 75v1472h-128v128h512v128q0 27 10 50t27.5 40.5t40.5 27.5t50 10h384q27 0 50 -10t40.5 -27.5t27.5 -40.5t10 -50v-128h512v-128zM768 1792h384v128h-384v-128zM1536 1664h-1152v-1472q0 -26 19 -45t45 -19h1024q26 0 45 19t19 45v1472zM768 384h-128v1024h128v-1024zM1024 384h-128v1024h128v-1024zM1280 384h-128v1024h128v-1024z' />
                  </g>
                
                </svg>"
                )
            OnSelect: =Remove(ReqDetails,ThisItem)
            Width: =30
            X: =545
            Y: =8
            ZIndex: =3

        Rectangle1 As rectangle:
            Fill: =theme.AppColor
            Height: =44
            OnSelect: =Select(Parent)
            Visible: =ThisItem.IsSelected
            Width: =13
            ZIndex: =5

        txt_ponum As text:
            BorderColor: =LightGray
            BorderThickness: =1
            Default: |-
                =If(
                    !IsBlank(Param("ID")),
                    LookUp(ReqHeader,Title=Param("ID"),PONum)
                ,varCurrentReqHeader.PONum)
            Font: =Font.Lato
            Height: =34
            OnSelect: =Select(Parent)
            Size: =14
            Width: =187
            X: =326
            Y: =4
            ZIndex: =6

    drpgalCat_CCS As dropdown:
        AllowEmptySelection: =true
        BorderColor: |-
            =ColorValue("#ccf5ff")
        BorderThickness: =1
        ChevronBackground: =theme.AppColor
        ChevronHoverBackground: =theme.AppColor
        Default: =varCurrentCostCode.Category
        FocusedBorderColor: =drpgalCat_CCS.BorderColor
        FocusedBorderThickness: =0
        Font: =Font.Lato
        FontWeight: =Normal
        Height: =60
        HoverBorderColor: =ColorFade(drpgalCat_CCS.BorderColor, 15%)
        HoverFill: |-
            =ColorValue("#ccf5ff")
        Items: =colcategory
        OnChange: =
        OnSelect: =
        PressedBorderColor: =drpgalCat_CCS.HoverBorderColor
        PressedFill: =theme.AppColor
        SelectionFill: =theme.AppColor
        Size: =18
        Width: =132
        X: =29
        Y: =1041
        ZIndex: =27

    lblAddNewReq_7 As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =37
        Size: =14
        Text: ="Vendor"
        Width: =112
        X: =10
        Y: =591
        ZIndex: =28

    lblDescr_CCS As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =39
        Size: =14
        Text: ="Description"
        Width: =213
        X: =16
        Y: =892
        ZIndex: =29

    grpAddReqDetails As group:
        Height: =5
        Width: =5
        X: =-37
        Y: =-340
        ZIndex: =29

        Image8_6 As image:
            Height: =40
            Image: |-
                ="data:image/svg+xml," & 
                 EncodeUrl(
                    "<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' viewBox='-10 0 2068 2048'>
                  <g transform='matrix(1 0 0 -1 0 2048),rotate(0,1034,1024)'>
                   <path fill='" & theme.AppColorText & "'
                d='M256 1536v-128h-128v128h128zM256 1280v-128h-128v128h128zM256 1024v-128h-128v128h128zM256 768v-128h-128v128h128zM256 512v-128h-128v128h128zM128 256h128v-128h-128v128zM256 0v128h128v-128h-128zM512 0v128h128v-128h-128zM256 1920h-128v128h128v-128zM512 2048v-128h-128v128h128zM768 2048v-128h-128v128h128zM1024 2048v-128h-128v128h128zM1280 2048v-128h-128v128h128zM1536 2048v-128h-128v128h128zM1664 1792h-128v128h128v-128zM1536 1536v128h128v-128h-128zM256 1792v-128h-128v128h128zM1920 1280q26 0 49.5 -10t41 -27.5t27.5 -41t10 -49.5v-1152h-1115l-165 165v987q0 26 10 49.5t27.5 41t41 27.5t49.5 10h1024zM1152 1152v-384h512v384h-512zM1664 128v256h-512v-256h128v128h128v-128h256zM1920 128v1024h-128v-512h-768v512h-128v-933l91 -91h37v384h768v-384h128z' />
                  </g>
                
                </svg>"
                )
            Width: =40
            X: =447
            Y: =1034
            ZIndex: =32

        Label2_1 As label:
            Color: =theme.AppColor
            PaddingLeft: =10
            Size: =14
            Text: ="Update  Details"
            Width: =118
            X: =487
            Y: =1038
            ZIndex: =33

        btnSave_15 As button:
            BorderColor: =theme.Blue
            BorderThickness: =1
            Color: =theme.AppColor
            DisabledColor: =Transparent
            DisabledFill: =Transparent
            DisplayMode: =
            Fill: =Transparent
            FocusedBorderColor: =theme.Orange
            FocusedBorderThickness: =1
            Height: =71
            HoverBorderColor: =theme.Orange
            HoverColor: =theme.AppColor
            HoverFill: =Transparent
            OnSelect: |-
                =Patch(ReqHeader,
                LookUp(
                    ReqHeader,
                    Title=lblReqID_1.Text
                ),
                {PONum:txt_ponum.Text
                
                }
                );
                
                
                Patch(
                    ReqDetails,
                    LookUp(
                        ReqDetails,
                        ID = varCurrentCostCode.ID
                    ),
                    {
                        Vendor: drpgalVendor_CCS.Selected.'Business Partner',
                        ItemDescription: txtDescription_CCS.Text,
                        CostCode: drpgalCostCode_CCS.Selected.CostCode,
                        Category: drpgalCat_CCS.Selected.Category,
                        ExpectedPrice:txtexpectedprice.Text,
                        Title: txt_partno.Text,
                        Quantity:txt_qty.Text,
                        UOM:dd_ccuom.Selected.Code,
                        DateRequired:dp_cced.SelectedDate,
                        PONo:txt_ponum.Text
                        
                    }
                );
                Set(varCoded,true);
                
                Set(varCurrentCostCode, LookUp(ReqDetails,ID=varCurrentCostCode.ID));
                Notify("Your item has been updated.")
            PaddingLeft: =50
            PressedBorderColor: =Transparent
            PressedColor: =Transparent
            PressedFill: =Transparent
            Size: =20
            Text: =""
            Tooltip: ="Save Change Records"
            Width: =169
            X: =436
            Y: =1021
            ZIndex: =34

    lblCC_CCS As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =39
        Size: =14
        Text: ="Cost Code"
        Width: =190
        X: =16
        Y: =781
        ZIndex: =30

    lblCat As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =39
        Size: =14
        Text: ="Category"
        Width: =131
        X: =23
        Y: =1006
        ZIndex: =31

    rctDivider As rectangle:
        Fill: =theme.AppColor
        Height: =6
        OnSelect: =
        Width: =640
        Y: =201
        ZIndex: =35

    rctDivider_1 As rectangle:
        Fill: =theme.AppColor
        Height: =6
        OnSelect: =
        Width: =640
        Y: =579
        ZIndex: =36

    Rectangle1_10 As rectangle:
        Fill: =theme.AppColor
        Height: =434
        OnSelect: =
        Visible: =varShowCCAttachements
        Width: =640
        Y: =220
        ZIndex: =37

    "Gallery2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
        Height: =256
        Items: =MyFiles
        Layout: =Layout.Vertical
        TemplateFill: =White
        TemplateSize: =51
        Visible: =varShowCCAttachements
        Width: =545
        X: =34
        Y: =316
        ZIndex: =38

        Image3 As image:
            Height: =40
            Image: |-
                =Switch(Last(Split(ThisItem.DisplayName,".")).Result,
                "pdf",
                "data:image/svg+xml," & 
                 EncodeUrl(
                    "<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' viewBox='-10 0 2068 2048'>
                  <g transform='matrix(1 0 0 -1 0 2048),rotate(0,1034,1024)'>
                   <path fill='#0086b3'
                d='M1920 384h-128v-384h-1664v384h-128v1024h128v640h1243l421 -421v-219h128v-1024zM1408 1664h165l-165 165v-165zM256 1408h1408v128h-384v384h-1024v-512zM1664 384h-1408v-256h1408v256zM1792 1280h-1664v-768h1664v768zM448 1152q40 0 75 -15t61 -41t41 -61t15 -75t-15 -75t-41 -61t-61 -41t-75 -15h-64v-128h-128v512h192zM448 896q26 0 45 19t19 45t-19 45t-45 19h-64v-128h64zM896 1152q53 0 99.5 -20t81.5 -55t55 -81.5t20 -99.5t-20 -99.5t-55 -81.5t-81.5 -55t-99.5 -20h-128v512h128zM896 768q27 0 50 10t40.5 27.5t27.5 40.5t10 50t-10 50t-27.5 40.5t-40.5 27.5t-50 10v-256zM1280 1152h320v-128h-192v-128h192v-128h-192v-128h-128v512z' />
                  </g>
                
                </svg>"
                )
                ,
                ThisItem.AbsoluteUri)
            OnSelect: =Select(Parent)
            Width: =40
            X: =10
            Y: =3
            ZIndex: =1

        Title1 As label:
            Height: =Self.Size * 1.8
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =14
            Text: =ThisItem.DisplayName
            VerticalAlign: =VerticalAlign.Top
            Width: =Parent.TemplateWidth - Image3.Width - 104
            Wrap: =false
            X: =70
            Y: =10
            ZIndex: =2

        Image3_1 As image:
            Height: =40
            Image: |-
                ="data:image/svg+xml," & 
                 EncodeUrl(
                    "<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' viewBox='-10 0 2068 2048'>
                  <g transform='matrix(1 0 0 -1 0 2048),rotate(0,1034,1024)'>
                   <path fill='#0086b3'
                d='M1536 1792h384v-384h-128v165l-456 -456l-91 91l456 456h-165v128zM1536 1024l128 128v-768h-1664v1152h1280l-128 -128h-1024v-896h1408v512z' />
                  </g>
                
                </svg>"
                )
            OnSelect: =Launch(ThisItem.AbsoluteUri)
            Width: =40
            X: =436
            Y: =3
            ZIndex: =4

    lblAddNewReq_8 As label:
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =37
        Size: =14
        Text: ="Attachments"
        Visible: =varShowCCAttachements
        Width: =222
        X: =38
        Y: =279
        ZIndex: =39

    galCCAttachments As gallery.galleryVertical:
        Height: =98
        Items: |-
            =
            If(
                !IsBlank(Param("ID")),
                Filter(ReqHeader,Title=Param("ID")),
            Filter(ReqHeader,Title=varCurrentReqHeader.Title))
        Layout: =Layout.Vertical
        OnSelect: |-
            =ClearCollect(
                MyFiles,
                First(
                    Filter(
                        ReqHeader,
                        ID = ThisItem.ID
                    )
                ).Attachments
            );
            Set(varShowCCAttachements, true)
        ShowScrollbar: =false
        TemplateSize: =92
        Width: =149
        X: =491
        Y: =103
        ZIndex: =40

        lblReqID_2 As label:
            Color: =RGBA(255, 255, 255, 1)
            Height: =31
            PaddingLeft: =8
            Size: =16
            Text: =CountRows(ThisItem.Attachments)
            Width: =36
            X: =73
            Y: =40
            ZIndex: =1

    Image4 As image:
        Height: =42
        Image: |-
            ="data:image/svg+xml," & 
             EncodeUrl(
                "<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' viewBox='-10 0 2068 2048'>
              <g transform='matrix(1 0 0 -1 0 2048),rotate(0,1034,1024)'>
               <path fill='white'
            d='M1169 1024l879 -879l-145 -145l-879 879l-879 -879l-145 145l879 879l-879 879l145 145l879 -879l879 879l145 -145z' />
              </g>
            
            </svg>"
            )
        OnSelect: =Set(varShowCCAttachements,false)
        Visible: =varShowCCAttachements
        Width: =45
        X: =561
        Y: =237
        ZIndex: =41

    lblAddNewReq_5 As label:
        Align: =Align.Center
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =37
        Size: =14
        Text: ="Part No"
        Width: =116
        X: =5
        Y: =221
        ZIndex: =42

    lblAddNewReq_6 As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =34
        Size: =14
        Text: ="Description"
        Width: =123
        X: =143
        Y: =221
        ZIndex: =43

    lblCC_CCS_1 As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =39
        Size: =14
        Text: ="Expected Price"
        Width: =190
        X: =200
        Y: =1007
        ZIndex: =44

    txtexpectedprice As text:
        BorderColor: |
            =ColorValue("#ccf5ff")
        BorderThickness: =1
        Default: =varCurrentCostCode.ExpectedPrice
        Font: =Font.Lato
        Height: =60
        Size: =18
        Width: =179
        X: =200
        Y: =1048
        ZIndex: =45

    drpgalCostCode_CCS As combobox:
        BorderColor: |-
            =ColorValue("#ccf5ff")
        BorderThickness: =1
        ChevronBackground: =theme.AppColor
        DefaultSelectedItems: =ForAll(colcostcode,CostCode)
        DisplayFields: =["CostCode","Description"]
        Font: =Font.Lato
        Height: =62
        Items: =NewCostCodes
        OnChange: =ClearCollect(colcategory,Filter('Final Cost Codes',Job="TM01" && CostCode=drpgalCostCode_CCS.Selected.CostCode).Category)
        SearchFields: =["Description"]
        SearchItems: =Search(NewCostCodes,drpgalCostCode_CCS.SearchText,"Description")
        SelectMultiple: =false
        Size: =14
        Template: =ListItemTemplate.Double
        Width: =370
        X: =17
        Y: =820
        ZIndex: =46

    Image12 As image:
        Height: =72
        Image: =TAC_Service_icons_circle_CALL
        OnSelect: |
            =Set(vendordialog,true);
        Tooltip: ="Contact Vendor"
        Width: =75
        X: =331
        Y: =605
        ZIndex: =47

    Grppreloader As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =56

        Preloader_1 As image:
            Height: =87
            Image: =autopreloader
            Visible: =varcsvimport
            Width: =61
            X: =540
            Y: =597
            ZIndex: =62

        Label16 As label:
            Color: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            Height: =70
            Size: =15
            Text: ="Importing"
            Visible: =varcsvimport
            Width: =103
            X: =518
            Y: =651
            ZIndex: =63

    Grpvendordialog As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =60

        Rectangle3 As rectangle:
            Fill: =RGBA(0, 0, 0, .5)
            Height: =1136
            Visible: =vendordialog
            Width: =640
            ZIndex: =48

        Rectangle4 As rectangle:
            Fill: =RGBA(244, 244, 244, 1)
            Height: =494
            Visible: =vendordialog
            Width: =612
            X: =16
            Y: =383
            ZIndex: =49

        Rectangle5 As rectangle:
            Fill: =theme.AppColor
            Height: =65
            Visible: =vendordialog
            Width: =618
            X: =10
            Y: =378
            ZIndex: =50

        Label11 As label:
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.Lato
            Height: =65
            Size: =21
            Text: ="Send an email to Vendor"
            Visible: =vendordialog
            Width: =441
            X: =94
            Y: =378
            ZIndex: =51

        Image13 As image:
            Height: =65
            Image: ='outlook-icon'
            Visible: =vendordialog
            Width: =94
            Y: =378
            ZIndex: =52

        Label12 As label:
            Font: =Font.Lato
            Height: =70
            Italic: =true
            Size: =16
            Text: ="Email"
            Visible: =vendordialog
            Width: =62
            X: =23
            Y: =443
            ZIndex: =53

        Label13 As label:
            Color: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            Height: =70
            Size: =16
            Text: ="Use ; if multiple emails"
            Visible: =vendordialog
            Width: =458
            X: =88
            Y: =442
            ZIndex: =54

        txt_costcodeemail As text:
            BorderColor: =LightGray
            BorderThickness: =1
            Default: =
            Font: =Font.Lato
            Height: =58
            HintText: ="Enter email address"
            HoverFill: =Transparent
            Italic: =true
            Size: =16
            Visible: =vendordialog
            Width: =584
            X: =17
            Y: =504
            ZIndex: =55

        Label12_1 As label:
            Font: =Font.Lato
            Height: =70
            Italic: =true
            Size: =16
            Text: ="Body"
            Visible: =vendordialog
            Width: =62
            X: =23
            Y: =567
            ZIndex: =56

        txt_costcodebody As text:
            BorderColor: =LightGray
            BorderThickness: =1
            Default: =
            Font: =Font.Lato
            Height: =116
            HintText: ="Enter message here"
            Italic: =true
            Mode: =TextMode.MultiLine
            Visible: =vendordialog
            Width: =589
            X: =23
            Y: =623
            ZIndex: =57

        Image14 As image:
            Height: =87
            Image: =ic_send_128_28719
            OnSelect: |-
                =Switch(
                    varVendorFormStatus,
                    "Edit",
                    Patch(ReqHeader, LookUp(ReqHeader, Title=lblReqID_1.Text),
                    { }, FrmAttachments.Updates
                    ),
                    "New",
                    Patch(ReqHeader, LookUp(ReqHeader, Title=lblReqID_1.Text),
                    { }, FrmAttachments.Updates
                    )
                );
                ResetForm(FrmAttachments);
                Set(varVendorFormStatus,"View");
                
                
                Set(varreqheader, LookUp(ReqHeader, Title=varreqid));
                Clear(colDataExported);
                
                
                Collect(colDataExported, {JobNo: lblReqJObNo_1.Text, Vendor: drpgalVendor_CCS.Selected.'Business Partner', Description: txtDescription_CCS.Text,
                 Quantity: varCurrentCostCode.Quantity, UOM: varCurrentCostCode.UOM, PartNo: varCurrentCostCode.Title, Location: lblReqDescription_1.Text, Approver: varreqheader.Approver.DisplayName, 
                'Date Required':varCurrentCostCode.DateRequired, User: User().FullName, Useremail: User().Email});
                Set(varFormattedJSON, JSON(colDataExported));
                
                'POReq-Vendors'.Run(varFormattedJSON,lblReqID_1.Text, txt_costcodebody.Text,txt_costcodeemail.Text);
                Notify("Your request was sent to the vendor");
                Set(vendordialog,false);
                Reset(txt_costcodebody);
                Reset(txt_costcodeemail)
            Visible: =vendordialog
            Width: =66
            X: =408
            Y: =765
            ZIndex: =58

        Label14 As label:
            Font: =Font.Lato
            Height: =47
            Size: =21
            Text: ="Send"
            Visible: =vendordialog
            Width: =106
            X: =474
            Y: =786
            ZIndex: =59

        Icon2 As icon.Cancel:
            Color: =RGBA(255, 0, 0, 1)
            Height: =56
            Icon: =Icon.Cancel
            OnSelect: =Set(vendordialog,false)
            Visible: =vendordialog
            Width: =54
            X: =218
            Y: =782
            ZIndex: =60

        Label15 As label:
            Font: =Font.Lato
            Height: =70
            Size: =21
            Text: ="Cancel"
            Visible: =vendordialog
            Width: =95
            X: =280
            Y: =774
            ZIndex: =61

    Image7 As image:
        Height: =67
        Image: |-
            ="data:image/svg+xml," & 
             EncodeUrl(
                "<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' viewBox='-10 0 2068 2048'>
              <g transform='matrix(1 0 0 -1 0 2048),rotate(0,1034,1024)'>
               <path fill='" & theme.AppColorText & "'
            d='M1536 1664v-1216q0 -93 -35.5 -174.5t-96 -142t-142 -96t-174.5 -35.5t-174.5 35.5t-142 96t-96 142t-35.5 174.5v1280q0 66 25.5 124t69 101.5t101.5 69t124 25.5t124 -25.5t101.5 -69t69 -101.5t25.5 -124v-1280q0 -40 -15 -75t-41 -61t-61 -41t-75 -15t-75 15t-61 41t-41 61t-15 75v1088h128v-1088q0 -26 19 -45t45 -19t45 19t19 45v1280q0 40 -15 75t-41 61t-61 41t-75 15t-75 -15t-61 -41t-41 -61t-15 -75v-1280q0 -66 25.5 -124t69 -101.5t101.5 -69t124 -25.5t124 25.5t101.5 69t69 101.5t25.5 124v1216h128z' />
              </g>
            
            </svg>"
            )
        OnSelect: |+
            =Set(varShowAttachments,true);
            If(varCurrentReqHeader.'Has attachments',
            Set(varVendorFormStatus, "Edit");
            EditForm(FrmAttachments);
            Clear(VarTempAttachmentsCol)
            ,
            Set(varVendorFormStatus, "New");
            NewForm(FrmAttachments);
            Clear(VarTempAttachmentsCol)
            );
            
            Set(varShowAttachments,true)
            
        Visible: =vendordialog
        Width: =52
        X: =33
        Y: =775
        ZIndex: =64

    Label15_1 As label:
        Font: =Font.Lato
        Height: =67
        Size: =20
        Text: ="Attach "
        Visible: =vendordialog
        Width: =107
        X: =88
        Y: =775
        ZIndex: =65

    Grpshowattachments As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =65

        Rectangle7 As rectangle:
            Fill: =theme.AppColor
            Height: =270
            Visible: =varShowAttachments
            Width: =611
            X: =10
            Y: =721
            ZIndex: =66

        FrmAttachments As form:
            DataSource: =ReqHeader
            DefaultMode: |-
                =Switch(
                    varVendorFormStatus,
                     "View", FormMode.View,
                    "New", FormMode.New,
                    "Edit",FormMode.Edit
                )
            Height: =269
            Item: |-
                =Switch(
                    varVendorFormStatus,
                    "View",
                    varCurrentReqHeader,
                    "New", Defaults(ReqHeader),
                    "Edit", varCurrentReqHeader
                )
            Visible: =varShowAttachments
            Width: =617
            X: =23
            Y: =721
            ZIndex: =67

            Attachments_DataCard1 As typedDataCard.attachmentsEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="{Attachments}"
                Default: =ThisItem.Attachments
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@ReqHeader],DataSourceInfo.DisplayName,"{Attachments}")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =254
                Required: =false
                Update: =DataCardValue6.Attachments
                Width: =618
                X: =0
                Y: =0
                ZIndex: =64

                DataCardKey6 As label:
                    Color: =RGBA(255, 255, 255, 1)
                    Font: =Font.Lato
                    Height: =39
                    Size: =18
                    Text: =Parent.DisplayName
                    Width: =183
                    Wrap: =false
                    X: =12
                    Y: =25
                    ZIndex: =1

                DataCardValue6 As attachments:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    DisplayMode: =Parent.DisplayMode
                    Height: =173
                    IsInDataCard: =true
                    Items: =Parent.Default
                    OnAddFile: =ClearCollect(VarTempAttachmentsCol, Self.Attachments)
                    OnRemoveFile: =ClearCollect(VarTempAttachmentsCol, Self.Attachments)
                    PaddingBottom: =5
                    PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                    PaddingRight: =5
                    PaddingTop: =5
                    Size: =21
                    Tooltip: =Parent.DisplayName
                    Width: =570
                    Y: =91
                    ZIndex: =2

                ErrorMessage6 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =24
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue6.Y + DataCardValue6.Height
                    ZIndex: =3

                StarVisible6 As label:
                    Align: =Align.Center
                    Height: =DataCardKey6.Height
                    Size: =21
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey6.Y
                    ZIndex: =4

        Icon3 As icon.Cancel:
            Color: =RGBA(255, 255, 255, 1)
            Height: =55
            Icon: =Icon.Cancel
            OnSelect: =Set(varShowAttachments,false)
            Visible: =varShowAttachments
            Width: =46
            X: =534
            Y: =739
            ZIndex: =68

    lblAddNewReq_9 As label:
        Font: =Font.Lato
        FontWeight: =Semibold
        Height: =34
        Size: =14
        Text: ="PO Number"
        Width: =123
        X: =361
        Y: =217
        ZIndex: =69

